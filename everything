{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 17,
   "metadata": {},
   "outputs": [],
   "source": [
    "import requests\n",
    "import spacy\n",
    "from bs4 import BeautifulSoup\n",
    "import re\n",
    "import praw\n",
    "from praw.models import MoreComments\n",
    "\n",
    "#client_id: jhAffV3EzTf80A\n",
    "#secret: f38Y5S9QTzm6y0LyG5UiU47sMKk\n",
    "#username: carameldeligh5\n",
    "#password: @Collingsworth5\n",
    "\n",
    "#scrapes google for top 10 links \n",
    "\n",
    "query = \"best places to eat in seattle reddit\"\n",
    "substring = \"comments/\"\n",
    "\n",
    "#FUNCTIONS \n",
    "\n",
    "#returns a list of post IDs \n",
    "def get_postIDs(query): \n",
    "    \n",
    "    page = requests.get(\"https://www.google.com/search?q=\" + term)\n",
    "    soup = BeautifulSoup(page.content, \"lxml\")\n",
    "    urls = soup.select(\".r a\")\n",
    "    links = [\"https://www.google.com\" + url.get('href') for url in urls]\n",
    "    \n",
    "    #could be extra processing here (LOOK DOWN)\n",
    "    links = links[1:]\n",
    "    \n",
    "    submissions = []\n",
    "    for link in links:\n",
    "        begIndex = link.index(substring) + 9\n",
    "        endIndex = begIndex + 6\n",
    "        submissions.append(link[begIndex : endIndex])\n",
    "    \n",
    "    return submissions\n",
    "        \n",
    "\n",
    "postIDs = get_postIDs(query)\n",
    "\n",
    "client_id = \"jhAffV3EzTf80A\"\n",
    "client_secret = \"f38Y5S9QTzm6y0LyG5UiU47sMKk\"\n",
    "username = \"carameldelight5\"\n",
    "password = \"@Collingsworth5\"\n",
    "\n",
    "reddit = praw.Reddit(client_id=client_id,\n",
    "                     client_secret=client_secret,\n",
    "                     password=password,\n",
    "                     user_agent='testscript by /u/carameldelight5',\n",
    "                     username=username)\n",
    "                     \n",
    "\n",
    "\n",
    "# TODO: uncomment - iterates through 10 reddit posts & gets top level comments for each post\n",
    "\n",
    "# postCount = 0 \n",
    "\n",
    "# for postID in postIDs: \n",
    "    \n",
    "#     print (\"POST: \" + str(postCount))\n",
    "#     post = reddit.submission(id = postID)\n",
    "#     commentCount = 0\n",
    "\n",
    "#     for top_level_comment in post.comments:\n",
    "#         if isinstance(top_level_comment, MoreComments):\n",
    "#             continue\n",
    "#         print (\"    COMMENT : \" + str(commentCount) + \" SCORE: \" + top_level_comment.)\n",
    "#         print(\"    \" + top_level_comment.body)\n",
    "        \n",
    "#         commentCount += 1\n",
    "\n",
    "#     postCount += 1\n",
    "\n",
    "\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 22,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "29\n"
     ]
    }
   ],
   "source": [
    "#nlp test \n",
    "testPost = reddit.submission(id = postIDs[0])\n",
    "testComment = testPost.comments[0]\n",
    "print (testComment.score)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Taiwanese NORP 379 \n",
      "\n",
      "Gourmet Noodle Bowl PERSON 378 \n",
      "\n",
      "International District GPE 382 \n",
      "\n",
      "Seattle GPE 382 \n",
      "\n",
      "Ethiopian NORP 379 \n",
      "\n",
      "Jebena Cafe PERSON 378 \n",
      "\n",
      "Northgate ORG 381 \n",
      "\n",
      "Cafe Selam ORG 381 \n",
      "\n",
      "Cafe Selam ORG 381 \n",
      "\n",
      "\n",
      " GPE 382 \n",
      "\n"
     ]
    }
   ],
   "source": [
    "nlp = spacy.load(\"en\")\n",
    "testCommentEnt = nlp(testComment.body)\n",
    "\n",
    "for ent in testCommentEnt.ents: \n",
    "    print(ent, end = \" \")\n",
    "    print(ent.label_, end = \" \")\n",
    "    print(ent.label, end = \" \")\n",
    "    print(\"\\n\") "
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "For Taiwanese hot pot and popcorn chicken, Gourmet Noodle Bowl in International District is my favorite. I've sampled popcorn chicken at other places in the ID and they're not as well-marinated as here.\n",
    "\n",
    "Seattle also has some great Ethiopian restaurants; my favorites are Jebena Cafe in Northgate area, and Cafe Selam more south. I like spicy foods and Cafe Selam has a delightful green chili paste that I haven't found anywhere else."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.4"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
